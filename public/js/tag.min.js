"use strict";riot.tag2("map-box",'<div class="map-box-container" id="{id}-container"> <div class="map-box-widget" id="{id}"></div> </div>','map-box .map-box-container,[riot-tag="map-box"] .map-box-container,[data-is="map-box"] .map-box-container{ position: relative; width: 100%; height: 400px; } map-box .map-box-container .map-box-widget,[riot-tag="map-box"] .map-box-container .map-box-widget,[data-is="map-box"] .map-box-container .map-box-widget{ position: absolute; top: 0; bottom: 0; left: 0; right: 0; } map-box .leaflet-map-pane,[riot-tag="map-box"] .leaflet-map-pane,[data-is="map-box"] .leaflet-map-pane{ z-index: 2 !important; } map-box .leaflet-google-layer,[riot-tag="map-box"] .leaflet-google-layer,[data-is="map-box"] .leaflet-google-layer{ z-index: 1 !important; }',"",function(i){function e(){o.map&&t(),o.map=L.map(o.id,o.map_options),o.map.setView(o.center),o.map.setZoom("auto"===o.map_options.zoom?15:+o.map_options.zoom);var i=L.tileLayer("https://{s}.{base}.maps.cit.api.here.com/maptile/2.1/{type}/{mapID}/{scheme}/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}&style={style}&ppi={ppi}",{attribution:'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",app_id:app.get("service.here.app_id"),app_code:app.get("service.here.app_code"),base:"base",maxZoom:20,type:"maptile",scheme:"ontouchstart"in window?"normal.day.mobile":"normal.day",language:"tha",style:"default",format:"png8",size:"256",ppi:"devicePixelRatio"in window&&window.devicePixelRatio>=2?"250":"72"});o.map.addLayer(i)}function a(){if(o.markers=_.map(o.pins,function(i){var e=L.marker(_.get(i,"location.coordinates"),{icon:o.YPIcon,interactive:!1,keyboard:!1,riseOnHover:!0});return o.pin_clickable&&e.bindPopup('<a href="#pins/'+i._id+'" target="_blank"><div class="pin-image" style="background-image: url('+(_.get(i,"photos.0")||util.site_url("/public/image/pin_photo.png"))+');"></div></a><div style="margin: 1rem 0;"><strong data-url="#user/'+i.owner+'">@'+app.get("app_user.name").toLowerCase()+"</strong> "+i.detail+'<a href="#pins/'+i._id+'" target="_blank" style="margin: 0 0.4rem;">View Pin</a></div>'),e.addTo(o.map),e}),o.markers.length>0){var i=new L.LatLngBounds(_.map(o.pins,function(i){return _.get(i,"location.coordinates")}));o.map.fitBounds(i),"auto"!==o.map_options.zoom&&o.map.setZoom(+o.map_options.zoom||17)}else console.log("No pins attached")}function t(){o.map&&(o.map.remove(),delete o.map)}var o=this;o.id="map-box-"+util.uniqueId();var n=/^options/i;o.map=null,o.map_options={zoom:17},_.forEach(i,function(i,e){if(n.test(e)){var a=_.camelCase(e.replace(n,""));if(!a)return;"false"===i?o.map_options[a]=!1:"true"===i?o.map_options[a]=!0:o.map_options[a]=i}}),o.center={lat:13.7304311,lng:100.5696901},o.markers=[],o.pin_clickable="false"!==i.pinClickable,o.pins=_.filter(i.pins||[],function(i){return!!_.get(i,"location.coordinates")}),o.YPIcon=L.icon({iconUrl:util.site_url("/public/image/marker-m-3d.png"),iconSize:[36,54],iconAnchor:[16,51],popupAnchor:[0,-51]}),o.on("mount",function(){e(),a()}),o.on("unmount",function(){}),o.on("update",function(){}),o.on("updated",function(){})}),riot.tag2("page-feed",'<div id="page-feed"> <div class="container no-padding-s"> <div class="spacing"></div> <h5 class="center" if="{title}">{title}</h5> <div class="row"> <div class="col s12 m6 l4" each="{pin in pins}"> <div class="card hover-card"><a class="card-image" href="#pins/{pin._id}{pin.mock ? &quot;?mock=1&quot; : &quot;&quot;}" riot-style="background-image: url({pin.photos &amp;&amp; pin.photos.length &gt; 0 ? pin.photos[0] : util.site_url(&quot;/public/image/pin_photo.png&quot;)})"></a> <div class="card-content"> <div class="card-description"> <div class="card-author"><strong data-url="#user/{pin.owner}">@{app.get(\'app_user.name\').toLowerCase()}</strong></div> <div class="card-text" html="{util.parse_tags(pin.detail)}"></div> <div class="tag-list" if="{pin.categories &amp;&amp; pin.categories.length &gt; 0}"><a class="tag-item" each="{cat in pin.categories}" href="#tags/{cat}">{cat}</a></div> </div> <div class="card-meta"> <div class="meta meta-time right">{moment(pin.created_time).fromNow()}</div> <div class="meta meta-status left" data-status="{pin.status}">{pin.status}</div> </div> </div> </div> </div> </div> <div class="center"> <button class="btn waves-effect waves-light white light-blue-text" if="{has_more &amp;&amp; !is_loading}" type="button" onclick="{clickLoadMore}"><i class="icon material-icons light-blue-text">expand_more</i>โหลดเพิ่ม</button> <preloader class="small" if="{is_loading}"></preloader> </div> <div class="spacing-large"></div> </div> </div>',"","",function(i){function e(){app.busy(),a.is_loading=!0,$.ajax({url:util.site_url("/pins",app.get("service.api.url")),data:_.assign({$sort:"-created_time"},a.query,{$skip:a.skip,$limit:a.limit})}).done(function(i){var e=i.data||[];a.skip+=Math.min(e.length,a.limit),a.has_more=e.length>=a.limit,a.pins=a.pins.concat(e)}).always(function(){a.is_loading=!1,app.busy(!1),a.update()})}var a=this;a.title=i.title,a.pins=i.pins||[],a.has_more=!1,a.skip=0,a.limit=30,a.query=i.query||{},a.is_loading=!1,a.on("mount",function(){e()}),a.on("updated",function(){$(a.root).find(".card-text").each(function(i,e){var a=$(e);a.html(a.attr("html"))})}),a.clickLoadMore=function(i){e()}}),riot.tag2("page-map",'<div id="page-map"> <map-box id="map-{id}" options-zoom="auto" options-scroll-wheel-zoom="false"></map-box> <div class="container no-padding-s" id="overlay-layer"> <button class="btn-floating waves-effect waves-light white" type="button" onclick="{setMapLocationByGeolocation}"><i class="icon material-icons light-blue-text">gps_fixed</i></button> </div> </div>',"","",function(i){function e(i){console.error(i.message),Materialize.toast('ไม่สามารถแสดงตำแหน่งปัจจุบันได้ <a href="/help" target="_blank">อ่านที่นี่เพื่อแก้ไข</a>',5e3,"dialog-error"),o.map.setView([13.756727,100.5018549],16)}function a(){app.busy(),o.is_loading=!0,$.ajax({url:util.site_url("/pins",app.get("service.api.url")),data:_.assign({$sort:"-created_time"},o.query,{$skip:o.skip,$limit:o.limit})}).done(function(i){var e=i.data||[];o.skip+=Math.min(e.length,o.limit),o.has_more=e.length>=o.limit,o.pins=o.pins.concat(e),o.has_more&&o.pins.length<500?a():t()}).always(function(){o.is_loading=!1,app.busy(!1)})}function t(){riot.mount("#map-"+o.id,{pins:o.pins}),o.map=_.get(o["map-"+o.id],"_tag.map")}var o=this;o.id="page-map-"+util.uniqueId(),o.title=i.title,o.pins=i.pins||[],o.has_more=!1,o.skip=0,o.limit=50,o.query=i.query||{},o.on("mount",function(){a()}),o.setMapLocationByGeolocation=function(i){i.preventDefault(),i.stopPropagation(),o.map&&(o.map.locate({setView:!0,maxZoom:16,enableHighAccuracy:!0}),o.map.off("locationerror",e),o.map.on("locationerror",e))}}),riot.tag2("page-pin",'<div id="page-pin"> <div class="fluid-container no-padding-s"> <div class="row"> <div class="col s12 m6 offset-m6"> <div class="spacing"></div> <div class="card"> <div class="card-image" if="{pin.photos.length === 0}" href="#pins/{pin._id}" riot-style="background-image: url({util.site_url(&quot;/public/image/pin_photo.png&quot;)})"></div> <div class="card-image responsive" if="{pin.photos.length &gt; 0}"> <div class="slider-container"> <div class="image-slider" id="photo-slider"> <div class="slider-item" each="{photo in pin.photos}"> <div class="image-item"> <div class="image" riot-style="background-image: url(&quot;{util.site_url(photo)}&quot;)"></div> </div> </div> </div> </div> </div> <div class="card-content"> <div class="pin-content"> <div class="card-description"> <div class="card-author"><strong data-url="#user/{pin.owner}">@{app.get(\'app_user.name\').toLowerCase()}</strong></div> <div class="card-text" html="{util.parse_tags(pin.detail)}"></div> <div class="tag-list" if="{pin.categories &amp;&amp; pin.categories.length &gt; 0}"><a class="tag-item" each="{cat in pin.categories}" href="#tags/{cat}">{cat}</a></div> </div> <div class="card-meta"> <div class="meta meta-time right">{moment(pin.created_time).fromNow()}</div> <div class="meta meta-status left" data-status="{pin.status}">{pin.status}</div> </div> </div> <div if="{pin.comments &amp;&amp; pin.comments.length &gt; 0}"> <div class="divider"></div> <h5 class="section-name">ความคิดเห็น</h5> <div class="comment-list"> <div class="comment-item" each="{comment in pin.comments}"> <div class="card-description"> <div class="card-author"><a href="#user/{comment.commented_by}">@{comment.commented_by}</a></div> <div class="card-text" html="{util.parse_tags(comment.detail)}"></div> </div> </div> </div> </div> </div> </div> </div> </div> </div> <div class="map-container"> <map-box pin-clickable="false" options-zoom="17" options-scroll-wheel-zoom="false" options-tap="false" options-keyboard="false"></map-box> </div> <div class="spacing-large"></div> </div>',"","",function(i){function e(){o.slider&&a(),o.$slider=$(o.root).find("#photo-slider"),o.$slider.on("init reinit",function(i){}).on("setPosition",function(i,e){}).slick({infinite:!0,speed:400,fade:o.fade,autoplay:!1,autoplaySpeed:o.autoplay_speed,accessibility:!1,cssEase:"ease-in"}),o.slider=!0}function a(){o.slider&&(o.$slider.slick("unslick"),o.slider=!1)}var t=this,o=this;o.pin=i,o.slider=!1,o.on("mount",function(){riot.mount("#page-pin map-box","map-box",{pins:[o.pin]})}),o.on("updated",function(){var i=$(t.root).find(".card-text");i.html(i.attr("html")),e()})}),riot.tag2("page-report",'<div class="modal bottom-sheet full-sheet" id="report-input-modal"> <div class="modal-header"> <nav> <ul class="left"> <li><a class="modal-action modal-close" href="#" onclick="{clickCloseReport}">ยกเลิก</a></li> </ul> <div class="center"><a class="brand-logo" href="#"></a> <div class="modal-title">ใส่ข้อมูลพิน</div> </div> <ul class="right"></ul> </nav> </div> <div class="modal-content no-padding-s"> <div class="container no-padding-s"> <div class="row"> <div class="col s12 m6 offset-m3 l4 offset-l4"> <form id="report-form"> <input type="hidden" name="location[coordinates][]:number" value="{location.lat}"> <input type="hidden" name="location[coordinates][]:number" value="{location.lng}"> <input type="hidden" name="location[type][]:string" value="Point"> <input each="{photo in photos}" type="hidden" name="photos[]" value="{photo.url}"> <input type="hidden" name="status" value="{status}"> <input type="hidden" name="owner" value="{owner}"> <input each="{provider in providers}" type="hidden" name="provider[]" value="{provider}"> <input type="hidden" name="level" value="normal"> <input type="hidden" name="neighborhood" value="{neighborhood}"> <div class="card"> <div class="card-image" if="{photos.length === 0}" href="#report" riot-style="background-image: url({util.site_url(&quot;/public/image/pin_photo_upload.png&quot;)})"> <button class="btn-floating btn-large waves-effect waves-light white" id="add-first-image-btn" type="button" onclick="{clickPhoto}"><i class="icon material-icons large light-blue-text">add</i></button> </div> <div class="card-image responsive" if="{photos.length &gt; 0}"> <div class="slider-container"> <div class="image-slider" id="photo-slider"> <div class="slider-item" each="{photo, i in photos}" data-i="{i}"> <div class="image-item" data-i="{i}" href="#!"> <div class="image" riot-style="background-image: url(&quot;{util.site_url(photo.url)}&quot;)"></div> </div> </div> </div> </div><a class="btn-floating btn-large waves-effect waves-light" id="add-image-btn" href="#report" onclick="{clickPhoto}"><i class="icon material-icons">add</i></a> </div> <div class="input-field" id="input-detail"> <textarea class="validate materialize-textarea" name="detail" placeholder="ใส่คำอธิบายปัญหาหรือข้อเสนอแนะ" oninput="{changeDetail}">{detail}</textarea> </div> <div class="card-content"> <div class="input-field" id="input-categories"><i class="icon material-icons prefix">local_offer</i> <select id="select-categories" name="categories" onchange="{changeCategories}"> <option value="">เลือกหมวดหมู่</option> <option each="{cat in choice_categories}" value="{cat.value}" __selected="{cat.selected}">{cat.text}</option> </select> </div> <div class="input-field" id="input-location" if="{!location}"><i class="icon material-icons prefix {location.lat ? &quot;active&quot; : &quot;&quot;}">place</i><a class="location-input input" href="#" onclick="{clickLocation}">{location_text}<i class="icon material-icons green-text small" if="{location}" style="vertical-align: top">check</i></a></div> </div> <div id="input-location-complete" if="{location}"> <map-box id="input-location-map" pin-clickable="false" options-dragging="false" options-zoom="15" options-zoom-control="false" options-scroll-wheel-zoom="false" options-double-click-zoom="false" options-touch-zoom="false" options-tap="false" options-keyboard="false"></map-box> <button class="btn-floating btn-large waves-effect waves-light white" id="edit-location-btn" type="button" onclick="{clickLocation}"><i class="icon material-icons large light-blue-text">edit</i></button> </div> </div> </form> </div> </div> </div> <div class="container no-padding-s"> <div class="row"> <div class="col s12 m6 offset-m3 l4 offset-l4"> <button class="btn btn-large btn-block {is_pin_complete ? &quot;&quot; : &quot;disabled&quot;}" id="submit-pin-btn" type="button" onclick="{clickSubmitReport}" __disabled="{!is_pin_complete}">โพสต์พิน</button> </div> </div> </div> </div> </div> <div class="modal bottom-sheet full-sheet" id="report-photo-modal"> <div class="modal-header"> <nav> <ul class="left"> <li><a class="modal-action modal-close" href="#report" onclick="{clickClosePhoto}">กลับ</a></li> </ul> <div class="center"><a class="brand-logo" href="#"></a> <div class="modal-title">เลือกภาพถ่าย</div> </div> <ul class="right"></ul> </nav> </div> <div class="modal-content no-padding-s"> <div class="container no-padding-s"> <div class="row card-list"> <div class="col s12 m6 offset-m3 l4 offset-l4" each="{photo, i in photos}"> <div class="card" data-i="{i}"> <div class="card-image responsive"><img riot-src="{util.site_url(photo.url)}"></div> </div> </div> <div class="col s12 m6 offset-m3 l4 offset-l4"> <div class="spacing"></div> <div class="drop-image-preview hide"></div> <div class="card-title center drop-image" name="dropzone-el"><i class="icon material-icons">photo_camera</i>เพิ่มรูป</div> </div> </div> </div> </div> </div> <div class="modal bottom-sheet full-sheet" id="report-map-modal"> <div class="modal-header"> <nav> <ul class="left"> <li><a class="modal-action modal-close" href="#report" onclick="{clickCloseMap}">กลับ</a></li> </ul> <div class="center"><a class="brand-logo" href="#"></a> <div class="modal-title">ตำแหน่งพิน</div> </div> <ul class="right"> <li><a href="#!" onclick="{setMapLocationByGeolocation}"><i class="icon material-icons">gps_fixed</i></a></li> </ul> </nav> </div> <div class="modal-content no-padding-s"> <div class="input-location-map" id="edit-location-map"></div><a class="btn btn-large btn-block modal-close" id="submit-location-btn" onclick="{clickCloseMap}">ใช้ตำแหน่งนี้</a> </div> </div> <div class="modal" id="report-uploading-modal"> <div class="modal-content"> <div class="progress"> <div class="indeterminate"></div> </div> <h4 class="center">กำลังอัพโหลด</h4> </div> </div> <div class="modal" id="report-saving-modal"> <div class="modal-content"> <div class="progress"> <div class="indeterminate"></div> </div> <h4 class="center">กำลังพิน</h4> </div> </div>','page-report .input-location-map,[riot-tag="page-report"] .input-location-map,[data-is="page-report"] .input-location-map{ position: absolute; top: 0; bottom: 0; left: 0; right: 0; } page-report .leaflet-map-pane,[riot-tag="page-report"] .leaflet-map-pane,[data-is="page-report"] .leaflet-map-pane{ z-index: 2 !important; } page-report .leaflet-google-layer,[riot-tag="page-report"] .leaflet-google-layer,[data-is="page-report"] .leaflet-google-layer{ z-index: 1 !important; }',"",function(i){function e(){p(),l(),v.target=i.target,v.detail="",v.categories="",v.status=v.default_status,v.photos=[],v.map=null,v.location=null,$(v.root).find('textarea[name="detail"]').val(""),$(v.root).find('select[name="categories"]').val(""),v.update()}function a(){v.dropzone||(v.dropzone=new Dropzone(v["dropzone-el"],{url:util.site_url("/api/image"),method:"POST",acceptedFiles:"image/*",paramName:"image",maxFilesize:5,previewsContainer:".drop-image-preview",previewTemplate:'<div class="dz-preview-template" style="display: none;"></div>',dictDefaultMessage:"",clickable:_.filter([$(v.target)[0],v["dropzone-el"],v["add-first-image-btn"]]),uploadMultiple:!0,fallback:function(){$(v.root).find(".dropzone").hide(),$(v.root).find(".dropzone-error").show()}}),v.dropzone.on("addedfile",function(i){}).on("sendingmultiple",function(i,e,a){t()}).on("successmultiple",function(i,e){for(var a=0;a<i.length;a++){var t=e[a];_.assignIn(t,{width:i[a].width,height:i[a].height}),v.photos.push(t)}$("#report-uploading-modal").closeModal(),o()}).on("errormultiple",function(i,e){console.error("error:",arguments),Materialize.toast("ไม่สามารถอัพโหลดรูปได้ ("+e+")",5e3,"dialog-error"),$("#report-uploading-modal").closeModal()}).on("completemultiple",function(i){}))}function t(){$("#report-uploading-modal").openModal({dismissible:!1})}function o(){v.redirect=app.current_hash||"#feed","#report"===v.redirect&&(v.redirect="#feed"),app["goto"]("report");var i=$(v["report-input-modal"]),a=$(v["report-photo-modal"]);i.hasClass("open")?v.photos.length<=1&&a.find(".modal-close").click():i.openModal({ready:function(){},complete:function(){e(),u(),app["goto"](v.redirect.slice(1))}}),v.update(),s()}function n(){v.is_pin_complete=!0,v.location||(v.is_pin_complete=!1),v.detail||(v.is_pin_complete=!1),v.categories||(v.is_pin_complete=!1),0===v.photos.length&&(v.is_pin_complete=!1)}function s(){v.slider&&l(),v.$slider=$(v.root).find("#photo-slider"),v.$slider.on("init reinit",function(i){}).on("setPosition",function(i,e){}).slick({infinite:!0,speed:400,fade:v.fade,autoplay:!1,autoplaySpeed:v.autoplay_speed,accessibility:!1,cssEase:"ease-in"}),v.slider=!0}function l(){v.slider&&(v.$slider.slick("unslick"),v.slider=!1)}function c(){v.map&&p(),v.map=L.map(v.map_id),v.map.locate({setView:!0,maxZoom:16}),v.map.on("locationfound",function(i){r(v.map.getCenter())}),v.map.on("locationerror",function(i){console.error(i.message),Materialize.toast('ไม่สามารถแสดงตำแหน่งปัจจุบันได้ <a href="/help" target="_blank">อ่านที่นี่เพื่อแก้ไข</a>',5e3,"dialog-error"),v.map.setView([13.756727,100.5018549],16)});var i=L.tileLayer("https://{s}.{base}.maps.cit.api.here.com/maptile/2.1/{type}/{mapID}/{scheme}/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}&style={style}",{attribution:'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",app_id:app.get("service.here.app_id"),app_code:app.get("service.here.app_code"),base:"base",maxZoom:20,type:"maptile",scheme:"ontouchstart"in window?"normal.day.mobile":"normal.day",language:"tha",style:"default",format:"png8",size:"256"});v.map.addLayer(i),v.map_marker=L.marker([v.DEFAULT_LOCATION.lat,v.DEFAULT_LOCATION.lng],{icon:v.YPIcon}).addTo(v.map),v.map.on("move",_.throttle(function(){r(v.map.getCenter())},100)),v.map.on("moveend zoomend resize",function(i){r(v.map.getCenter())})}function p(){v.map&&(v.map.remove(),delete v.map)}function r(i){v.location=i,v.map_marker.setLatLng(i),v.update(),riot.mount("#input-location-map",{pins:[{location:{coordinates:v.location,type:"Point"}}]})}function d(i){$("#report-input-modal").addClass("inactive"),$("#report-photo-modal").openModal({ready:function(){},complete:function(){s()}})}function m(){$("#report-saving-modal").openModal({dismissible:!1});var i=$("#report-form").serializeJSON();i.categories=_.map(i.categories&&"string"==typeof i.categories?i.categories.split(","):[],function(i){return _.trim(i)}),i.tags=util.extract_tags(i.detail),i.tags=i.tags.concat(i.categories),i.created_time=Date.now(),i.updated_time=i.created_time,$.ajax({url:util.site_url("/pins",app.get("service.api.url")),method:"post",headers:{Authorization:"Bearer "+app.get("app_token")},beforeSend:function(i){i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Accept","application/json")},dataType:"json",data:JSON.stringify(i)}).done(function(i){e(),u(),app["goto"]("pins/"+i._id)}).fail(function(i){console.error("error:",i),Materialize.toast("ไม่สามารถพินปัญหาได้ ("+i+")",5e3,"dialog-error")})}function u(){$("#report-saving-modal").closeModal(),$("#report-input-modal").closeModal(),$("#report-input-modal").removeClass("inactive")}var v=this;v.dropzone=null,v.slider=!1,v.is_pin_complete=!1,v.redirect="",v.detail="",v.categories="",v.photos=[],v.target=i.target,v.map=null,v.map_id="edit-location-map",v.location=null,v.default_status="verified",v.status=v.default_status,v.neighborhood="",v.owner=app.get("app_user._id"),v.providers=[app.get("app_user._id")],v.DEFAULT_LOCATION={lat:13.7302295,lng:100.5724075},v.YPIcon=L.icon({iconUrl:util.site_url("/public/image/marker-m.png"),iconSize:[32,51],iconAnchor:[16,48],popupAnchor:[0,-51]}),v.choice_categories=[{value:"footpath",text:"ทางเท้า",selected:!1},{value:"pollution",text:"มลภาวะ",selected:!1},{value:"roads",text:"ถนน",selected:!1},{value:"publictransport",text:"ขนส่งสาธารณะ",selected:!1},{value:"garbage",text:"ขยะ",selected:!1},{value:"drainage",text:"ระบายน้ำ",selected:!1},{value:"trees",text:"ต้นไม้",selected:!1},{value:"safety",text:"ความปลอดภัย",selected:!1},{value:"violation",text:"ละเมิดสิทธิ",selected:!1}],v.on("update",function(){v.location_text=v.location&&"number"==typeof v.location.lat?"ปักตำแหน่งแล้ว":"ใส่ตำแหน่ง",n()}),v.on("mount",function(){}),v.on("unmount",function(){}),v.on("updated",function(){a(),$("#select-categories").material_select("destroy"),$("#select-categories").material_select()}),v.showReportView=o,v.changeDetail=function(i){v.detail=i.currentTarget.value,v.update()},v.changeCategories=function(i){v.categories=i.currentTarget.value,v.update()},v.clickPhoto=function(i){i.preventDefault(),i.stopPropagation(),d()},v.changePhotoText=function(i){var e=+$(i.target).attr("data-i");v.photos[e].text=i.value},v.clickLocation=function(i){i.preventDefault(),i.stopPropagation(),$("#report-input-modal").addClass("inactive"),$("#report-map-modal").openModal({ready:function(){v.map||c()},complete:function(){v.location}})},v.setMapLocationByGeolocation=function(i){i.preventDefault(),i.stopPropagation(),v.map&&v.map.locate({setView:!0,maxZoom:16,enableHighAccuracy:!0})},v.clickSubmitReport=function(i){i.preventDefault(),i.stopPropagation(),m()},v.clickClosePhoto=function(i){$("#report-input-modal").removeClass("inactive")},v.clickCloseMap=function(i){$("#report-input-modal").removeClass("inactive")},v.clickCloseReport=function(i){i.preventDefault(),i.stopPropagation(),e(),u(),app["goto"](v.redirect)}}),riot.tag2("preloader",'<div class="preloader-wrapper active {class}"> <div class="spinner-layer spinner-blue-only"> <div class="circle-clipper left"> <div class="circle"></div> </div> <div class="gap-patch"> <div class="circle"></div> </div> <div class="circle-clipper right"> <div class="circle"></div> </div> </div> </div>',"","",function(i){var e=this;e["class"]=i["class"]});